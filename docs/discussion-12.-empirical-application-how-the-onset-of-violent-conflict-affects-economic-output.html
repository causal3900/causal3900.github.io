<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Discussion 12. Empirical Application: How the Onset of Violent Conflict Affects Economic Output | Causal Inference Course</title>
<meta name="author" content="Ian Lundberg and Sam Wang">
<meta name="description" content="We will demonstrate the synthetic control method using data from Abadie and Gardeazabal (2003), which studied the economic effects of conflict, using the terrorist conflict in the Basque Country...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Discussion 12. Empirical Application: How the Onset of Violent Conflict Affects Economic Output | Causal Inference Course">
<meta property="og:type" content="book">
<meta property="og:description" content="We will demonstrate the synthetic control method using data from Abadie and Gardeazabal (2003), which studied the economic effects of conflict, using the terrorist conflict in the Basque Country...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Discussion 12. Empirical Application: How the Onset of Violent Conflict Affects Economic Output | Causal Inference Course">
<meta name="twitter:description" content="We will demonstrate the synthetic control method using data from Abadie and Gardeazabal (2003), which studied the economic effects of conflict, using the terrorist conflict in the Basque Country...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css">
<script src="https://tikzjax.com/v1/tikzjax.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Causal Inference Course</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="defining-counterfactuals.html"><span class="header-section-number">1</span> Defining counterfactuals</a></li>
<li class="book-part">Identification by exchangeability</li>
<li><a class="" href="exchangeability-and-experiments.html"><span class="header-section-number">2</span> Exchangeability and experiments</a></li>
<li><a class="" href="consistency-and-positivity.html"><span class="header-section-number">3</span> Consistency and positivity</a></li>
<li><a class="" href="directed-acyclic-graphs.html"><span class="header-section-number">4</span> Directed Acyclic Graphs</a></li>
<li><a class="" href="statistical-modeling.html"><span class="header-section-number">5</span> Statistical modeling</a></li>
<li class="book-part">Identification without exchangeability</li>
<li><a class="" href="front-door.html"><span class="header-section-number">6</span> Front door</a></li>
<li><a class="" href="instrumental-variables.html"><span class="header-section-number">7</span> Instrumental variables</a></li>
<li><a class="" href="regression-discontinuity.html"><span class="header-section-number">8</span> Regression discontinuity</a></li>
<li><a class="" href="difference-in-difference.html"><span class="header-section-number">9</span> Difference in difference</a></li>
<li><a class="" href="synthetic-control.html"><span class="header-section-number">10</span> Synthetic control</a></li>
<li class="book-part">Areas of active research</li>
<li><a class="" href="data-driven-methods.html"><span class="header-section-number">11</span> Data-driven methods</a></li>
<li><a class="" href="current-research.html"><span class="header-section-number">12</span> Current research</a></li>
<li><a class="" href="course-recap.html"><span class="header-section-number">13</span> Course recap</a></li>
<li class="book-part">Discussions</li>
<li><a class="" href="discussion-02.-stats-review.html">Discussion 02. Stats review</a></li>
<li><a class="" href="discussion-03.-analyzing-an-experiment-in-r.html">Discussion 03. Analyzing an Experiment in R</a></li>
<li><a class="" href="discussion-03.-analyzing-an-experiment-in-r-solutions.html">Discussion 03. Analyzing an Experiment in R SOLUTIONS</a></li>
<li><a class="" href="discussion-07.-causal-effects-with-matching.html">Discussion 07. Causal Effects with Matching</a></li>
<li><a class="" href="discussion-10.-causal-effects-with-regression-discontinuity.html">Discussion 10. Causal Effects with Regression Discontinuity</a></li>
<li><a class="active" href="discussion-12.-empirical-application-how-the-onset-of-violent-conflict-affects-economic-output.html">Discussion 12. Empirical Application: How the Onset of Violent Conflict Affects Economic Output</a></li>
<li class="book-part">Assignments</li>
<li><a class="" href="due-dates.html">Due dates</a></li>
<li><a class="" href="final-project.html">Final Project</a></li>
<li><a class="" href="problem-set-1.-definitions.html">Problem Set 1. Definitions</a></li>
<li><a class="" href="problem-set-2.-experiments.html">Problem Set 2. Experiments</a></li>
<li><a class="" href="problem-set-3.-dags..html">Problem Set 3. DAGs.</a></li>
<li><a class="" href="problem-set-4.-statistical-modeling.html">Problem Set 4. Statistical modeling</a></li>
<li><a class="" href="problem-set-5.-iv-rd.html">Problem Set 5. IV + RD</a></li>
<li><a class="" href="problem-set-6.-difference-in-difference-synthetic-control.html">Problem Set 6. Difference in Difference + Synthetic Control</a></li>
<li class="book-part">Course information</li>
<li><a class="" href="who-we-are.html">Who we are</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="discussion-12.-empirical-application-how-the-onset-of-violent-conflict-affects-economic-output" class="section level1 unnumbered">
<h1>Discussion 12. Empirical Application: How the Onset of Violent Conflict Affects Economic Output<a class="anchor" aria-label="anchor" href="#discussion-12.-empirical-application-how-the-onset-of-violent-conflict-affects-economic-output"><i class="fas fa-link"></i></a>
</h1>
<p>We will demonstrate the synthetic control method using data from <a href="https://www.aeaweb.org/articles?id=10.1257/000282803321455188">Abadie and
Gardeazabal (2003)</a>, which studied the economic effects of conflict, using the
terrorist conflict in the Basque Country as a case study. This paper used a
combination of other Spanish regions to construct a synthetic Basque Country
resembling many relevant economic characteristics of the Basque Country before
the onset of political terrorism in the 1970s.</p>
<div id="load-the-data" class="section level2" number="13.15">
<h2>
<span class="header-section-number">13.15</span> Load the Data<a class="anchor" aria-label="anchor" href="#load-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s go ahead and load our packages and data. If you notice that there is quite
a lot of missing data, don’t worry, that’s how it is meant to be!</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">install</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">package</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">package</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">package</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">package</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="fu">install</span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">install</span><span class="op">(</span><span class="st">"Synth"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"basque"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">basque</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 774
## Columns: 17
## $ regionno              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ regionname            &lt;chr&gt; "Spain (Espana)", "Spain (Es…
## $ year                  &lt;dbl&gt; 1955, 1956, 1957, 1958, 1959…
## $ gdpcap                &lt;dbl&gt; 2.354542, 2.480149, 2.603613…
## $ sec.agriculture       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 19.5…
## $ sec.energy            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 4.71…
## $ sec.industry          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 26.4…
## $ sec.construction      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 6.27…
## $ sec.services.venta    &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 36.6…
## $ sec.services.nonventa &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 6.44…
## $ school.illit          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …
## $ school.prim           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …
## $ school.med            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …
## $ school.high           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …
## $ school.post.high      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …
## $ popdens               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …
## $ invest                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, …</code></pre>
</div>
<div id="data-definitions" class="section level2" number="13.16">
<h2>
<span class="header-section-number">13.16</span> Data definitions<a class="anchor" aria-label="anchor" href="#data-definitions"><i class="fas fa-link"></i></a>
</h2>
<p>The following are definitions of all the variables you see above:</p>
<ul>
<li><p><code>regionno</code> and <code>regionname</code>: Numeric identifiers for each Spanish region,
and the names (as a character) of each region.</p></li>
<li><p><code>year</code>: The year corresponding with each row of the data. Spans from
1955-1997.</p></li>
<li><p><code>gdpcap</code>: 1960–1969 averages for real GDP per-capita measured in thousands of
1986 USD.</p></li>
<li><p>Variables with <code>sec.</code> prefix: 1961–1969 average percentage of total GDP for
six different industries. For example, the first non-missing value of
<code>sec.agriculture</code> is = 19.54. This means that in 1961, the Agriculture industry
made up about 20% of the total GDP in all of Spain (note the <code>regionname</code>
variable = <code>Spain (Espana)</code>.</p></li>
<li><p>Variables with <code>school.</code> prefix: 1964–1969 averages for the share of the
working-age population that was illiterate (<code>school.illit</code>), the share with up
to primary school education (<code>school.prim</code>), the share with some high school
(<code>school.med</code>), the share with high school (<code>school.high</code>), and the share with
more than high school (<code>school.post.high</code>).</p></li>
<li><p><code>popdens</code>: 1969 population density measured in people per square kilometer.</p></li>
<li><p><code>invest</code>: 1964–1969 averages for gross total investment divided by total GDP.</p></li>
</ul>
<p>Running the following line of code will show you some helpful information in the “Help” box on the bottom right of your R Studio Screen. We call this <em>documentation</em>. It tells you what the outcome variable and predictor variables are, plus descriptions of each variable in the dataset. Please ask us if you have any additional questions about what each variable means.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">basque</span></span></code></pre></div>
<div id="questions-for-you" class="section level3" number="13.16.1">
<h3>
<span class="header-section-number">13.16.1</span> Questions For You<a class="anchor" aria-label="anchor" href="#questions-for-you"><i class="fas fa-link"></i></a>
</h3>
<p>After running the code above and reading the documentation for the dataset, answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What years are contained in the dataset?</li>
</ol>
<p><strong>Answer.</strong></p>
<ol start="2" style="list-style-type: decimal">
<li>How many Spanish regions are contained in the dataset?</li>
</ol>
<p><strong>Answer.</strong></p>
<ol start="3" style="list-style-type: decimal">
<li>What is the outcome variable and what is it called in the dataset?</li>
</ol>
<p><strong>Answer.</strong></p>
<ol start="4" style="list-style-type: decimal">
<li>What are the possible predictor variables?</li>
</ol>
<p><strong>Answer.</strong></p>
</div>
</div>
<div id="prepare-the-data-for-analysis-using-dataprep" class="section level2" number="13.17">
<h2>
<span class="header-section-number">13.17</span> Prepare the data for analysis using <code>dataprep</code><a class="anchor" aria-label="anchor" href="#prepare-the-data-for-analysis-using-dataprep"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>first step</strong> is to reorganize the dataset into an appropriate format that is
suitable for the main estimator function <code>synth()</code>. To do this, we will use the
<code>dataprep()</code> function. To see more examples and details on data extraction, run
<code>?dataprep</code> in your console. This should pop up a helpful page in the “Help” tab on the bottom right of your R Studio screen.</p>
<p>In the code below, we need to tell Synth the following:</p>
<ol style="list-style-type: decimal">
<li>What our predictor variables are (split up into two groups)</li>
</ol>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>
<code>predictors</code>: variables that are non-missing for all years included in our analysis</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>
<code>special.predictors</code>: for predictor variables with missing values or require a little extra handling</li>
</ol></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>How we want these predictor variables to be aggregated (in our case, the average)</li>
<li>What time period we are considering (in our case, 1964 to 1969)</li>
<li>What the outcome variable is (in our case, <code>gdpcap</code>)</li>
<li>What variable(s) identify the different regions (<code>regionname</code>) and/or
numbers (<code>regionno</code>).</li>
<li>What variable denotes the time period (<code>year</code>)</li>
<li>Which region is the treated unit (region 17 AKA Basque Country)</li>
<li>Which regions are control units (<code>c(2:16,18)</code>)</li>
<li>What time period we want to train out model in (pre-treatment period 1960:1969)</li>
<li>The time-period over which our outcome data should be plotted
(usually before and after treatment, e.g., 1955 to 1997)</li>
</ol>
<p>Okay, now let’s prepare what we’ve just described in code.
We’ve added comments in the code to explain exactly what’s happening in each line.
We are creating a “prepared” dataset <code>dataprep.out</code> by running our “unprepared” data through the <code>dataprep</code> function.
This is because the Synth package requires the data to be in a specific format to do synthetic control.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataprep.out</span> <span class="op">&lt;-</span> <span class="fu">dataprep</span><span class="op">(</span></span>
<span>  foo <span class="op">=</span> <span class="va">basque</span>,          <span class="co"># Our analysis data that needs to be prepared</span></span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>        <span class="co"># 1(a). list the variables that we want to use as predictors</span></span>
<span>    <span class="st">"school.illit"</span>,     </span>
<span>    <span class="st">"school.prim"</span>,       </span>
<span>    <span class="st">"school.med"</span>,</span>
<span>    <span class="st">"school.high"</span>,</span>
<span>    <span class="st">"school.post.high"</span>,</span>
<span>    <span class="st">"invest"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  predictors.op <span class="op">=</span> <span class="st">"mean"</span>,               <span class="co"># 2. Tell Synth to take the average of all variables in `predictors` above.</span></span>
<span>  time.predictors.prior <span class="op">=</span> <span class="fl">1964</span><span class="op">:</span><span class="fl">1969</span>,    <span class="co"># 3. Take the average of variables in `predictors` from 1964 to 1969.</span></span>
<span>  special.predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>            <span class="co"># 1(b). Additional variables to include as predictors in our model:</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"gdpcap"</span>, <span class="fl">1960</span><span class="op">:</span><span class="fl">1969</span> , <span class="st">"mean"</span><span class="op">)</span>, <span class="co"># -    Take the average of `gdcap` from 1960 to 1969</span></span>
<span>                                        <span class="co"># -    Take the average of all others for every OTHER year from 1961 to 1969</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sec.agriculture"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sec.energy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sec.industry"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sec.construction"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sec.services.venta"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sec.services.nonventa"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"popdens"</span>, <span class="fl">1969</span>, <span class="st">"mean"</span><span class="op">)</span>       <span class="co"># -    Take the average of `popdens` only in 1969</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dependent <span class="op">=</span> <span class="st">"gdpcap"</span>,                 <span class="co"># 4. Specify our outcome variable</span></span>
<span>  unit.variable <span class="op">=</span> <span class="st">"regionno"</span>,           <span class="co"># 5(a). Specify the numeric identifier of each region</span></span>
<span>  unit.names.variable <span class="op">=</span> <span class="st">"regionname"</span>,   <span class="co"># 5(b). Specify the name of each region</span></span>
<span>  time.variable <span class="op">=</span> <span class="st">"year"</span>,               <span class="co"># 6. Specify what variable is our time variable</span></span>
<span>  treatment.identifier <span class="op">=</span> <span class="fl">17</span>,            <span class="co"># 7. Specify which region in `regionno` is our treated region</span></span>
<span>  controls.identifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">16</span>, <span class="fl">18</span><span class="op">)</span>,    <span class="co"># 8. Specify which regions in `regionno` should be in our donor pool</span></span>
<span>  time.optimize.ssr <span class="op">=</span> <span class="fl">1960</span><span class="op">:</span><span class="fl">1969</span>,        <span class="co"># 9. Specify what years should make up our pre-treatment time period</span></span>
<span>  time.plot <span class="op">=</span> <span class="fl">1955</span><span class="op">:</span><span class="fl">1997</span>                 <span class="co"># 10. Specify what years to plot our outcome variable for</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Notice that in the code above we use the arguments <code>predictors</code>,
<code>predictors.op</code>, and <code>time.predictors.prior</code>, and the rest of the information
for the other predictor variables is specified in the <code>special.predictors</code>
list. This functionality was designed to allow for easy handling of
several predictors with the same operator (e.g. taking the average) over the
same pre-treatment period (in this case, the school and investment variables)
as well as additional custom (or “special”) predictors with varying operators
and time-periods. For example, the variables for the sector production
shares (e.g. <code>sec.agriculture</code>) is only available on a biennial basis
(1961,1963,…,1969) extracted which is why we use the code <code>seq(1961,1969,2)</code>.
More details and examples on the use of the <code>special.predictors</code>
can be seen by running <code>?dataprep</code> in the console.</p>
</div>
<div id="construct-our-synthetic-control" class="section level2" number="13.18">
<h2>
<span class="header-section-number">13.18</span> Construct our Synthetic Control<a class="anchor" aria-label="anchor" href="#construct-our-synthetic-control"><i class="fas fa-link"></i></a>
</h2>
<p>Now, we’re ready to use the <code>synth()</code> function to create the synthetic control
for the GDP of the Basque Country region of Spain. As described in discussion,
this means that <code>synth()</code> will create weights for each of the other regions
so that the weighted average of the other regions’ GDP will closely match the
true GDP of the Basque Country region.</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.out</span> <span class="op">&lt;-</span> <span class="fu">synth</span><span class="op">(</span>data.prep.obj <span class="op">=</span> <span class="va">dataprep.out</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## X1, X0, Z1, Z0 all come directly from dataprep object.
## 
## 
## **************** 
##  searching for synthetic control unit  
##  
## 
## **************** 
## **************** 
## **************** 
## 
## MSPE (LOSS V): 0.008864605 
## 
## solution.v:
##  0.03881798 0.001220442 4.26792e-05 0.0001235262 1.6599e-06 1.76355e-05 0.04072702 0.2396775 0.02234054 0.248494 0.005974697 0.01098894 0.04858995 0.3429834 
## 
## solution.w:
##  1.67e-08 4.27e-08 7.43e-08 2.78e-08 2.97e-08 5.545e-07 3.66e-08 4.28e-08 0.8508029 9.23e-08 2.75e-08 4.94e-08 0.1491958 4.13e-08 9.75e-08 1.167e-07</code></pre>
<p>We’ll explore the model output below.</p>
</div>
<div id="summarizing-our-synthetic-control-with-tables" class="section level2" number="13.19">
<h2>
<span class="header-section-number">13.19</span> Summarizing our Synthetic Control with Tables<a class="anchor" aria-label="anchor" href="#summarizing-our-synthetic-control-with-tables"><i class="fas fa-link"></i></a>
</h2>
<p>First, we can begin by creating some summary tables from our Synthetic Control
model.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.tables</span> <span class="op">&lt;-</span> <span class="fu">synth.tab</span><span class="op">(</span>dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>, synth.res <span class="op">=</span> <span class="va">synth.out</span><span class="op">)</span></span></code></pre></div>
<p>The <code>synth.tables</code> variable now contains four tables that will help us evaluate
our synthetic control. The first table looks at our pre-treatment period and
compares the predictor values between the Basque Country (denoted <code>Treated</code> in
the table) and our Synthetic Control. <strong>Note</strong> we want the values in the
<code>Treated</code> and <code>Synthetic</code> columns to be really close together.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.tables</span><span class="op">$</span><span class="va">tab.pred</span></span></code></pre></div>
<pre><code>##                                          Treated Synthetic
## school.illit                              39.888   256.335
## school.prim                             1031.742  2730.092
## school.med                                90.359   223.341
## school.high                               25.728    63.437
## school.post.high                          13.480    36.154
## invest                                    24.647    21.583
## special.gdpcap.1960.1969                   5.285     5.271
## special.sec.agriculture.1961.1969          6.844     6.179
## special.sec.energy.1961.1969               4.106     2.760
## special.sec.industry.1961.1969            45.082    37.636
## special.sec.construction.1961.1969         6.150     6.952
## special.sec.services.venta.1961.1969      33.754    41.104
## special.sec.services.nonventa.1961.1969    4.072     5.371
## special.popdens.1969                     246.890   196.287
##                                         Sample Mean
## school.illit                                170.786
## school.prim                                1127.186
## school.med                                   76.260
## school.high                                  24.235
## school.post.high                             13.478
## invest                                       21.424
## special.gdpcap.1960.1969                      3.581
## special.sec.agriculture.1961.1969            21.353
## special.sec.energy.1961.1969                  5.310
## special.sec.industry.1961.1969               22.425
## special.sec.construction.1961.1969            7.276
## special.sec.services.venta.1961.1969         36.528
## special.sec.services.nonventa.1961.1969       7.111
## special.popdens.1969                         99.414</code></pre>
<p>We can see that the values in the <code>Treated</code> and <code>Synthetic</code> columns are pretty
different for some variables so this would indicate that perhaps our synthetic
control isn’t as similar as we would like.</p>
<p>Next, we can look at the weights that got assigned to each of the non-treatment
regions. We can drop regions that have a weight of 0 since those regions don’t
contribute to our synthetic control at all!</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.tables</span><span class="op">$</span><span class="va">tab.w</span><span class="op">[</span><span class="va">synth.tables</span><span class="op">$</span><span class="va">tab.w</span><span class="op">$</span><span class="va">w.weights</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="op">]</span></span></code></pre></div>
<pre><code>##    w.weights            unit.names unit.numbers
## 10     0.851              Cataluna           10
## 14     0.149 Madrid (Comunidad De)           14</code></pre>
<p>From the <code>w.weights</code> column we can see that only two regions contribute to our
synthetic control. The Cataluna region makes up approximately 85% of our
synthetic control and the Madrid region makes up the additional 15%. This means
that out of 16 regions in our donor pool, only 2 of them were picked to create
our synthetic control!</p>
<p>Finally we can look at the weights that got assigned to each of our predictor
variables. This can be interpreted as the relative importance of each of our
predictor variables.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.tables</span><span class="op">$</span><span class="va">tab.v</span></span></code></pre></div>
<pre><code>##                                         v.weights
## school.illit                            0.039    
## school.prim                             0.001    
## school.med                              0        
## school.high                             0        
## school.post.high                        0        
## invest                                  0        
## special.gdpcap.1960.1969                0.041    
## special.sec.agriculture.1961.1969       0.24     
## special.sec.energy.1961.1969            0.022    
## special.sec.industry.1961.1969          0.248    
## special.sec.construction.1961.1969      0.006    
## special.sec.services.venta.1961.1969    0.011    
## special.sec.services.nonventa.1961.1969 0.049    
## special.popdens.1969                    0.343</code></pre>
<p>We can see that the <code>school.med</code>, <code>school.high</code>, <code>school.post.high</code>, and
<code>invest</code> variables had a weight of 0, which means that they are the least
important and had no impact in the creation of our synthetic control. On the
other hand, the population density in 1969 (<code>special.popdens.1969</code>) was the
most important variable.</p>
</div>
<div id="summarizing-our-synthetic-control-with-plots" class="section level2" number="13.20">
<h2>
<span class="header-section-number">13.20</span> Summarizing our Synthetic Control with Plots<a class="anchor" aria-label="anchor" href="#summarizing-our-synthetic-control-with-plots"><i class="fas fa-link"></i></a>
</h2>
<p>Finally, we can plot the economic output for the Basque Contry region and
compare it to the economic output for our Synthetic Control. To make a
convincing case for a large treatment effect, we would like to see the two
trajectories of the outcome variable for the Basque Country and its Synthetic
Control unit to be quite similar prior to the violent conflict and to diverge
sharply when the violent conflict occurs.</p>
<p>Let’s create such a plot and see if it indicates a significant treatment effect.</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">path.plot</span><span class="op">(</span></span>
<span>  synth.res <span class="op">=</span> <span class="va">synth.out</span>,</span>
<span>  dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>,</span>
<span>  Ylab <span class="op">=</span> <span class="st">"real per-capita GDP (1986 USD, thousand)"</span>,</span>
<span>  Xlab <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  Ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  Legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Basque country"</span>, <span class="st">"synthetic Basque country"</span><span class="op">)</span>,</span>
<span>  Legend.position <span class="op">=</span> <span class="st">"bottomright"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="cn">NULL</span>, b <span class="op">=</span> <span class="cn">NULL</span>, h <span class="op">=</span> <span class="cn">NULL</span>, v <span class="op">=</span> <span class="fl">1975</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="discussion12_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>We can see that the economic output of both units looks super similar until
1975 which is when the violent conflict began in earnest. From that point on,
the economic output of the Basque Country drops significantly. This would
indicate that the violent conflict had a fairly large and negative impact on
economic output in the Basque Country region.</p>
<p>Another way we can visualize this is by creating the same plot, but instead
of showing two lines for the outcome of the Basque Country region and the
outcome of the Synthetic Control Unit, we plot a single line that is the
difference between the two lines in each time period.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gaps.plot</span><span class="op">(</span></span>
<span>  synth.res <span class="op">=</span> <span class="va">synth.out</span>,</span>
<span>  dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>,</span>
<span>  Ylab <span class="op">=</span> <span class="st">"gap in real per-capita GDP (1986 USD, thousand)"</span>,</span>
<span>  Xlab <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  Ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  Main <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="cn">NULL</span>, b <span class="op">=</span> <span class="cn">NULL</span>, h <span class="op">=</span> <span class="cn">NULL</span>, v <span class="op">=</span> <span class="fl">1975</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="discussion12_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
<p>This plot conveys the same information as before. That is, the economic output
of the Basque Country region drops well below the economic output of the
Synthetic Control unit once the violent conflict begins in 1975. In other words
the violent conflict lowers economic output.</p>
</div>
<div id="summary" class="section level2" number="13.21">
<h2>
<span class="header-section-number">13.21</span> Summary<a class="anchor" aria-label="anchor" href="#summary"><i class="fas fa-link"></i></a>
</h2>
<p>In this tutorial, we’ve walked through how to prepare data for the Synthetic
Control method with the following steps:</p>
<ul>
<li><p>Prepare your data using the <code>dataprep()</code> function.</p></li>
<li><p>Create a Synthetic Control unit using the <code>synth</code> function.</p></li>
<li><p>Evaluate our model with tables using the <code>synth.tab</code> function.</p></li>
<li><p>Plot the outcomes of our treated unit and our synthetic control unit with the
<code>path.plot</code> and <code>gaps.plot</code> functions.</p></li>
</ul>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="discussion-10.-causal-effects-with-regression-discontinuity.html">Discussion 10. Causal Effects with Regression Discontinuity</a></div>
<div class="next"><a href="due-dates.html">Due dates</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#discussion-12.-empirical-application-how-the-onset-of-violent-conflict-affects-economic-output">Discussion 12. Empirical Application: How the Onset of Violent Conflict Affects Economic Output</a></li>
<li><a class="nav-link" href="#load-the-data"><span class="header-section-number">13.15</span> Load the Data</a></li>
<li>
<a class="nav-link" href="#data-definitions"><span class="header-section-number">13.16</span> Data definitions</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#questions-for-you"><span class="header-section-number">13.16.1</span> Questions For You</a></li></ul>
</li>
<li><a class="nav-link" href="#prepare-the-data-for-analysis-using-dataprep"><span class="header-section-number">13.17</span> Prepare the data for analysis using dataprep</a></li>
<li><a class="nav-link" href="#construct-our-synthetic-control"><span class="header-section-number">13.18</span> Construct our Synthetic Control</a></li>
<li><a class="nav-link" href="#summarizing-our-synthetic-control-with-tables"><span class="header-section-number">13.19</span> Summarizing our Synthetic Control with Tables</a></li>
<li><a class="nav-link" href="#summarizing-our-synthetic-control-with-plots"><span class="header-section-number">13.20</span> Summarizing our Synthetic Control with Plots</a></li>
<li><a class="nav-link" href="#summary"><span class="header-section-number">13.21</span> Summary</a></li>
</ul>
      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="syllabus" href="assets/Syllabus_Causal_Inference_3900.pdf">Syllabus </a></li>
          <li><a id="canvas" href="https://canvas.cornell.edu/courses/57329">Canvas </a></li>
          <li><a id="ed" href="https://edstem.org/us/courses/40928">Ed Discussion </a></li>
          
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>Last built on 2023-11-28</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This site was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
